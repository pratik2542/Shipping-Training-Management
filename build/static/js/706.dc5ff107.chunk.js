"use strict";(self.webpackChunkddrops=self.webpackChunkddrops||[]).push([[706],{706:(e,t,a)=>{a.r(t),a.d(t,{default:()=>w});var s=a(5043),r=a(7872),i=a(3336),n=a(1045),o=a(5865),l=a(6446),d=a(7424),c=a(1906),m=a(8797),u=a(6822),g=a(3216),p=a(6325),x=a(3612),h=a(5472),f=a(5983),A=a(8483),v=a(7392),j=a(1637);const y=e=>{const t=`https://shipping-management.vercel.app/api${e}`;return console.log("API Request to:",t),t};var S=a(579);const b=["pratikmak2542@gmail.com"],w=()=>{console.log("API URL:",{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_API_URL);const[e,t]=(0,s.useState)(""),[a,w]=(0,s.useState)(""),[C,T]=(0,s.useState)(""),[R,k]=(0,s.useState)(""),[P,_]=(0,s.useState)(!1),[W,I]=(0,s.useState)(!1),[q,E]=(0,s.useState)(!1),[D,F]=(0,s.useState)(!1),O=(0,g.Zp)();return(0,S.jsx)(r.A,{component:"main",maxWidth:"xs",children:(0,S.jsxs)(i.A,{elevation:3,sx:{marginTop:8,padding:4,display:"flex",flexDirection:"column",alignItems:"center"},children:[(0,S.jsx)(n.A,{sx:{m:1,bgcolor:"primary.main"},children:(0,S.jsx)(p.A,{})}),(0,S.jsx)(o.A,{component:"h1",variant:"h5",sx:{mb:3},children:W?"Register":P?"Create Test Account":"Sign in"}),R&&(0,S.jsx)(o.A,{color:"error",sx:{mb:2},children:R}),(0,S.jsx)(l.A,{component:"form",onSubmit:W?async t=>{if(t.preventDefault(),!D){F(!0);try{const t=(0,h.P)((0,h.rJ)(u.db,"userRequests"),(0,h._M)("email","==",e),(0,h._M)("status","==","pending"));if(!(await(0,h.GG)(t)).empty)return alert("You already have a pending registration request."),void F(!1);const a={name:C,email:e,status:"pending",createdAt:(new Date).toISOString(),isTestUser:!1};await(async e=>{try{console.log("Sending notification to:",y("/notify-admin"));const t=await fetch(y("/notify-admin"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),a=await t.json();if(console.log("Server response:",a),!t.ok)throw new Error(a.error||"Failed to send notification");return a}catch(R){throw console.error("Detailed error:",R),R}})(a),await(0,h.gS)((0,h.rJ)(u.db,"userRequests"),a),alert("Registration request submitted successfully."),O("/pending-status",{state:{email:e}})}catch(R){console.error("Registration failed:",R),k(`Registration failed: ${R.message}`),alert("Failed to submit registration. Please try again.")}finally{F(!1)}}}:P?async t=>{t.preventDefault();try{await(0,m.eJ)(x.z,e,a),localStorage.setItem("isTestUser","true"),O("/dashboard")}catch(R){k(R.message)}}:async t=>{t.preventDefault();try{if(await(0,m.x9)(u.j,e,a),"tempPassword123"===a)return void O("/reset-password",{state:{fromTempPassword:!0}});if(b.includes(e)){const e=(0,h.P)((0,h.rJ)(u.db,"userRequests"),(0,h._M)("status","==","pending")),t=await(0,h.GG)(e);return localStorage.setItem("isAdmin","true"),void(t.size>0?O("/admin/verify"):O("/dashboard"))}if(q)await(0,m.x9)(x.z,e,a),localStorage.setItem("isTestUser","true");else{await(0,m.x9)(u.j,e,a);const t=(0,h.P)((0,h.rJ)(u.db,"userRequests"),(0,h._M)("email","==",e),(0,h._M)("status","==","pending"));if(!(await(0,h.GG)(t)).empty)return await u.j.signOut(),void k("Your account is pending approval. Please wait for admin verification.");localStorage.removeItem("isAdmin"),localStorage.removeItem("isTestUser"),O("/dashboard")}}catch(R){k(R.message)}},sx:{mt:1},children:W?(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(d.A,{margin:"normal",required:!0,fullWidth:!0,label:"Full Name",value:C,onChange:e=>T(e.target.value),sx:{mb:2}}),(0,S.jsxs)(l.A,{sx:{position:"relative"},children:[(0,S.jsx)(d.A,{margin:"normal",required:!0,fullWidth:!0,label:"Email Address",value:e,onChange:e=>t(e.target.value),sx:{mb:3}}),(0,S.jsx)(A.A,{title:"After your registration is approved, you'll receive an email with a temporary password to log in.",arrow:!0,placement:"top",children:(0,S.jsx)(v.A,{sx:{position:"absolute",right:-40,top:"50%",transform:"translateY(-50%)"},children:(0,S.jsx)(f.A,{color:"primary",fontSize:"small"})})})]}),(0,S.jsx)(c.A,{type:"submit",fullWidth:!0,variant:"contained",color:"primary",sx:{mt:3,mb:2},disabled:D,children:D?(0,S.jsxs)(l.A,{sx:{display:"flex",alignItems:"center"},children:[(0,S.jsx)(j.A,{size:24,sx:{mr:1}}),"Registering..."]}):"Register"}),(0,S.jsx)(c.A,{fullWidth:!0,variant:"outlined",onClick:()=>{I(!1),T("")},sx:{mt:1},children:"Back to Login"})]}):(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(d.A,{margin:"normal",required:!0,fullWidth:!0,label:"Email Address",value:e,onChange:e=>t(e.target.value),sx:{mb:2}}),(0,S.jsx)(d.A,{margin:"normal",required:!0,fullWidth:!0,label:"Password",type:"password",value:a,onChange:e=>w(e.target.value),sx:{mb:3}}),P||W?(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(c.A,{type:"submit",fullWidth:!0,variant:"contained",color:"warning",sx:{mt:3,mb:2},children:"Create Test Account"}),(0,S.jsx)(c.A,{fullWidth:!0,variant:"outlined",onClick:()=>{_(!1),E(!1)},sx:{mt:1},children:"Back to Login"})]}):(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(c.A,{type:"submit",fullWidth:!0,variant:"contained",size:"large",sx:{py:1.5,fontSize:"1.1rem","&:hover":{transform:"translateY(-2px)",transition:"transform 0.2s"}},children:"Sign In"}),(0,S.jsxs)(l.A,{sx:{display:"flex",justifyContent:"space-between",mt:1,mb:2},children:[(0,S.jsx)(c.A,{color:"primary",onClick:()=>O("/check-status"),sx:{textTransform:"none"},children:"Check Registration Status"}),(0,S.jsx)(c.A,{color:"primary",onClick:()=>O("/forgot-password"),sx:{textTransform:"none"},children:"Forgot password?"})]}),(0,S.jsx)(c.A,{fullWidth:!0,variant:"outlined",onClick:()=>I(!0),sx:{mt:1},children:"Create Account"}),(0,S.jsx)(c.A,{fullWidth:!0,variant:"outlined",onClick:()=>{_(!0),E(!0)},sx:{mt:1},children:"Create Test Account"})]})]})})]})})}}}]);
//# sourceMappingURL=706.dc5ff107.chunk.js.map