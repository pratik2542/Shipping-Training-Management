"use strict";(self.webpackChunkddrops=self.webpackChunkddrops||[]).push([[706],{706:(e,t,a)=>{a.r(t),a.d(t,{default:()=>b});var r=a(5043),s=a(7872),i=a(3336),n=a(1045),o=a(5865),l=a(6446),d=a(7424),c=a(1906),m=a(8797),u=a(6822),g=a(3216),p=a(6325),h=a(3612),x=a(5472),f=a(5983),A=a(8483),v=a(7392),j=a(1637);var y=a(579);const S=["pratikmak2542@gmail.com"],b=()=>{console.log("API URL:",{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_API_URL);const[e,t]=(0,r.useState)(""),[a,b]=(0,r.useState)(""),[w,C]=(0,r.useState)(""),[T,P]=(0,r.useState)(""),[R,k]=(0,r.useState)(!1),[_,W]=(0,r.useState)(!1),[I,E]=(0,r.useState)(!1),[F,q]=(0,r.useState)(!1),O=(0,g.Zp)(),D=async e=>{try{console.log("Sending notification with data:",e);const t=await fetch((e=>{const t=`https://shipping-management.vercel.app/api${e}`;return console.log("Testing API endpoint:",t),t})("/notify-admin"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),a=await t.json();if(console.log("Server response:",a),!t.ok)throw new Error(a.error||"Failed to send notification");return a}catch(T){throw console.error("Notification error:",T),new Error("Failed to send registration notification. Please try again.")}};return(0,y.jsx)(s.A,{component:"main",maxWidth:"xs",children:(0,y.jsxs)(i.A,{elevation:3,sx:{marginTop:8,padding:4,display:"flex",flexDirection:"column",alignItems:"center"},children:[(0,y.jsx)(n.A,{sx:{m:1,bgcolor:"primary.main"},children:(0,y.jsx)(p.A,{})}),(0,y.jsx)(o.A,{component:"h1",variant:"h5",sx:{mb:3},children:_?"Register":R?"Create Test Account":"Sign in"}),T&&(0,y.jsx)(o.A,{color:"error",sx:{mb:2},children:T}),(0,y.jsx)(l.A,{component:"form",onSubmit:_?async t=>{if(t.preventDefault(),!F){q(!0);try{const t=(0,x.P)((0,x.rJ)(u.db,"userRequests"),(0,x._M)("email","==",e),(0,x._M)("status","==","pending"));if(!(await(0,x.GG)(t)).empty)return alert("You already have a pending registration request."),void q(!1);const a={name:w,email:e,status:"pending",createdAt:(new Date).toISOString(),isTestUser:!1};await D(a),await(0,x.gS)((0,x.rJ)(u.db,"userRequests"),a),alert("Registration request submitted successfully."),O("/pending-status",{state:{email:e}})}catch(T){console.error("Registration failed:",T),P(`Registration failed: ${T.message}`),alert("Failed to submit registration. Please try again.")}finally{q(!1)}}}:R?async t=>{t.preventDefault();try{await(0,m.eJ)(h.z,e,a),localStorage.setItem("isTestUser","true"),O("/dashboard")}catch(T){P(T.message)}}:async t=>{t.preventDefault();try{if(await(0,m.x9)(u.j,e,a),"tempPassword123"===a)return void O("/reset-password",{state:{fromTempPassword:!0}});if(S.includes(e)){const e=(0,x.P)((0,x.rJ)(u.db,"userRequests"),(0,x._M)("status","==","pending")),t=await(0,x.GG)(e);return localStorage.setItem("isAdmin","true"),void(t.size>0?O("/admin/verify"):O("/dashboard"))}if(I)await(0,m.x9)(h.z,e,a),localStorage.setItem("isTestUser","true");else{await(0,m.x9)(u.j,e,a);const t=(0,x.P)((0,x.rJ)(u.db,"userRequests"),(0,x._M)("email","==",e),(0,x._M)("status","==","pending"));if(!(await(0,x.GG)(t)).empty)return await u.j.signOut(),void P("Your account is pending approval. Please wait for admin verification.");localStorage.removeItem("isAdmin"),localStorage.removeItem("isTestUser"),O("/dashboard")}}catch(T){P(T.message)}},sx:{mt:1},children:_?(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(d.A,{margin:"normal",required:!0,fullWidth:!0,label:"Full Name",value:w,onChange:e=>C(e.target.value),sx:{mb:2}}),(0,y.jsxs)(l.A,{sx:{position:"relative"},children:[(0,y.jsx)(d.A,{margin:"normal",required:!0,fullWidth:!0,label:"Email Address",value:e,onChange:e=>t(e.target.value),sx:{mb:3}}),(0,y.jsx)(A.A,{title:"After your registration is approved, you'll receive an email with a temporary password to log in.",arrow:!0,placement:"top",children:(0,y.jsx)(v.A,{sx:{position:"absolute",right:-40,top:"50%",transform:"translateY(-50%)"},children:(0,y.jsx)(f.A,{color:"primary",fontSize:"small"})})})]}),(0,y.jsx)(c.A,{type:"submit",fullWidth:!0,variant:"contained",color:"primary",sx:{mt:3,mb:2},disabled:F,children:F?(0,y.jsxs)(l.A,{sx:{display:"flex",alignItems:"center"},children:[(0,y.jsx)(j.A,{size:24,sx:{mr:1}}),"Registering..."]}):"Register"}),(0,y.jsx)(c.A,{fullWidth:!0,variant:"outlined",onClick:()=>{W(!1),C("")},sx:{mt:1},children:"Back to Login"})]}):(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(d.A,{margin:"normal",required:!0,fullWidth:!0,label:"Email Address",value:e,onChange:e=>t(e.target.value),sx:{mb:2}}),(0,y.jsx)(d.A,{margin:"normal",required:!0,fullWidth:!0,label:"Password",type:"password",value:a,onChange:e=>b(e.target.value),sx:{mb:3}}),R||_?(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(c.A,{type:"submit",fullWidth:!0,variant:"contained",color:"warning",sx:{mt:3,mb:2},children:"Create Test Account"}),(0,y.jsx)(c.A,{fullWidth:!0,variant:"outlined",onClick:()=>{k(!1),E(!1)},sx:{mt:1},children:"Back to Login"})]}):(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(c.A,{type:"submit",fullWidth:!0,variant:"contained",size:"large",sx:{py:1.5,fontSize:"1.1rem","&:hover":{transform:"translateY(-2px)",transition:"transform 0.2s"}},children:"Sign In"}),(0,y.jsxs)(l.A,{sx:{display:"flex",justifyContent:"space-between",mt:1,mb:2},children:[(0,y.jsx)(c.A,{color:"primary",onClick:()=>O("/check-status"),sx:{textTransform:"none"},children:"Check Registration Status"}),(0,y.jsx)(c.A,{color:"primary",onClick:()=>O("/forgot-password"),sx:{textTransform:"none"},children:"Forgot password?"})]}),(0,y.jsx)(c.A,{fullWidth:!0,variant:"outlined",onClick:()=>W(!0),sx:{mt:1},children:"Create Account"}),(0,y.jsx)(c.A,{fullWidth:!0,variant:"outlined",onClick:()=>{k(!0),E(!0)},sx:{mt:1},children:"Create Test Account"})]})]})})]})})}}}]);
//# sourceMappingURL=706.4ab4b3dd.chunk.js.map