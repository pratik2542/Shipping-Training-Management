"use strict";(self.webpackChunkddrops=self.webpackChunkddrops||[]).push([[698],{39:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return s.createSvgIcon}});var s=r(4421)},4421:(e,t,r)=>{r.r(t),r.d(t,{capitalize:()=>a.A,createChainedFunction:()=>n,createSvgIcon:()=>o.A,debounce:()=>i.A,deprecatedPropType:()=>c,isMuiElement:()=>l.A,ownerDocument:()=>d.A,ownerWindow:()=>u.A,requirePropFactory:()=>m,setRef:()=>p,unstable_ClassNameGenerator:()=>v,unstable_useEnhancedEffect:()=>h.A,unstable_useId:()=>g.A,unsupportedProp:()=>w,useControlled:()=>y.A,useEventCallback:()=>b.A,useForkRef:()=>f.A,useIsFocusVisible:()=>j.A});var s=r(9386),a=r(6803);const n=r(2456).A;var o=r(9662),i=r(950);const c=function(e,t){return()=>null};var l=r(7328),d=r(2427),u=r(6078);r(8168);const m=function(e,t){return()=>null};const p=r(6564).A;var h=r(5013),g=r(5879);const w=function(e,t,r,s,a){return null};var y=r(5420),b=r(3319),f=r(5849),j=r(3574);const v={configure:e=>{s.A.configure(e)}}},5879:(e,t,r)=>{r.d(t,{A:()=>s});const s=r(5844).A},6476:(e,t,r)=>{r.r(t),r.d(t,{default:()=>T});var s=r(5043),a=r(9252),n=r(6446),o=r(5865),i=r(1906),c=r(3336),l=r(1806),d=r(4882),u=r(8076),m=r(2420),p=r(3460),h=r(5472),g=r(6822),w=r(3216),y=r(3639),b=r(1702),f=r(9786);class j{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Network Error";this.status=e,this.text=t}}const v={origin:"https://api.emailjs.com",blockHeadless:!1,storageProvider:(()=>{if("undefined"!==typeof localStorage)return{get:e=>Promise.resolve(localStorage.getItem(e)),set:(e,t)=>Promise.resolve(localStorage.setItem(e,t)),remove:e=>Promise.resolve(localStorage.removeItem(e))}})()},A=e=>e?"string"===typeof e?{publicKey:e}:"[object Object]"===e.toString()?e:{}:{},x=async function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const s=await fetch(v.origin+e,{method:"POST",headers:r,body:t}),a=await s.text(),n=new j(s.status,a);if(s.ok)return n;throw n},S=(e,t,r)=>{if(!e||"string"!==typeof e)throw"The public key is required. Visit https://dashboard.emailjs.com/admin/account";if(!t||"string"!==typeof t)throw"The service ID is required. Visit https://dashboard.emailjs.com/admin";if(!r||"string"!==typeof r)throw"The template ID is required. Visit https://dashboard.emailjs.com/admin/templates"},E=e=>e.webdriver||!e.languages||0===e.languages.length,I=()=>new j(451,"Unavailable For Headless Browser"),k=(e,t)=>{if((e=>!e.list?.length||!e.watchVariable)(e))return!1;((e,t)=>{if(!Array.isArray(e))throw"The BlockList list has to be an array";if("string"!==typeof t)throw"The BlockList watchVariable has to be a string"})(e.list,e.watchVariable);const r=(s=t,a=e.watchVariable,s instanceof FormData?s.get(a):s[a]);var s,a;return"string"===typeof r&&e.list.includes(r)},C=()=>new j(403,"Forbidden"),P=async(e,t,r)=>{if(!t.throttle||!r)return!1;((e,t)=>{if("number"!==typeof e||e<0)throw"The LimitRate throttle has to be a positive number";if(t&&"string"!==typeof t)throw"The LimitRate ID has to be a non-empty string"})(t.throttle,t.id);const s=t.id||e,a=await(async(e,t,r)=>{const s=Number(await r.get(e)||0);return t-Date.now()+s})(s,t.throttle,r);return a>0||(await r.set(s,Date.now().toString()),!1)},R=()=>new j(429,"Too Many Requests"),D=async(e,t,r,s)=>{const a=A(s),n=a.publicKey||v.publicKey,o=a.blockHeadless||v.blockHeadless,i=a.storageProvider||v.storageProvider,c={...v.blockList,...a.blockList},l={...v.limitRate,...a.limitRate};if(o&&E(navigator))return Promise.reject(I());if(S(n,e,t),(e=>{if(e&&"[object Object]"!==e.toString())throw"The template params have to be the object. Visit https://www.emailjs.com/docs/sdk/send/"})(r),r&&k(c,r))return Promise.reject(C());if(await P(location.pathname,l,i))return Promise.reject(R());const d={lib_version:"4.4.1",user_id:n,service_id:e,template_id:t,template_params:r};return x("/api/v1.0/email/send",JSON.stringify(d),{"Content-type":"application/json"})},_=async e=>{let{to:t,name:r,subject:s,html:a}=e;try{const e={to_email:t,to_name:r,subject:s,message:a},n=await D("service_1pw3job","template_d7h6i4d",e,"P_vvkj76LJzEvipCY");return console.log("Email sent successfully:",n),n}catch(n){throw console.error("Error sending email:",n),new Error("Error sending email")}};var q=r(579);const T=()=>{const e=(0,w.Zp)(),[t,r]=(0,s.useState)([]);(0,s.useEffect)((()=>{j()}),[]);const j=async()=>{try{const e=(await(0,h.GG)((0,h.rJ)(g.db,"userRequests"))).docs.map((e=>({...e.data(),id:e.id}))).filter((e=>"pending"===e.status));r(e)}catch(e){console.error("Error fetching pending users:",e)}};return(0,q.jsxs)(a.A,{maxWidth:"lg",children:[(0,q.jsxs)(n.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:4,mt:4},children:[(0,q.jsx)(o.A,{variant:"h4",sx:{mt:2},children:"User Verification Requests"}),(0,q.jsxs)(n.A,{children:[(0,q.jsx)(i.A,{variant:"contained",startIcon:(0,q.jsx)(y.A,{}),onClick:()=>e("/dashboard"),sx:{mr:2,mt:2},children:"Dashboard"}),(0,q.jsx)(i.A,{variant:"outlined",startIcon:(0,q.jsx)(b.A,{}),onClick:async()=>{try{await(0,f.CI)(g.j),localStorage.removeItem("isAdmin"),e("/")}catch(t){console.error("Error during logout:",t),e("/")}},sx:{mt:2},children:"Logout"})]})]}),(0,q.jsx)(c.A,{elevation:3,sx:{p:4},children:(0,q.jsxs)(l.A,{children:[(0,q.jsx)(d.A,{children:(0,q.jsxs)(u.A,{children:[(0,q.jsx)(m.A,{children:"Name"}),(0,q.jsx)(m.A,{children:"Email"}),(0,q.jsx)(m.A,{children:"Date Requested"}),(0,q.jsx)(m.A,{children:"Actions"})]})}),(0,q.jsx)(p.A,{children:t.map((e=>(0,q.jsxs)(u.A,{children:[(0,q.jsx)(m.A,{children:e.name}),(0,q.jsx)(m.A,{children:e.email}),(0,q.jsx)(m.A,{children:new Date(e.createdAt).toLocaleDateString()}),(0,q.jsx)(m.A,{children:(0,q.jsxs)(n.A,{sx:{display:"flex",gap:1},children:[(0,q.jsx)(i.A,{variant:"contained",color:"success",onClick:()=>(async e=>{try{const r=g.j.currentUser.email,s=await new Promise((e=>{const t=document.createElement("input");t.type="password",t.placeholder="Enter admin password";const r=document.createElement("div");r.style.position="fixed",r.style.top="50%",r.style.left="50%",r.style.transform="translate(-50%, -50%)",r.style.backgroundColor="white",r.style.padding="20px",r.style.boxShadow="0 0 10px rgba(0,0,0,0.5)",r.style.zIndex="1000",r.appendChild(t);const s=document.createElement("button");s.textContent="Submit",s.onclick=()=>{r.remove(),e(t.value)},r.appendChild(s),document.body.appendChild(r),t.focus()})),a=localStorage.getItem("isAdmin");try{await(0,f.x9)(g.j,r,s),localStorage.setItem("isAdmin",a)}catch(t){return void alert("Invalid admin password. Approval cancelled.")}const n=(0,f.xI)(),o="tempPassword123";try{const t=await(0,f.eJ)(n,e.email,o);await _({to:e.email,name:e.name,subject:"Account Approved - Temporary Password",html:o}),await(0,h.BN)((0,h.H9)(g.db,"usersData",t.user.uid),{uid:t.user.uid,name:e.name,email:e.email,createdAt:(new Date).toISOString(),isTestUser:!1}),await(0,h.mZ)((0,h.H9)(g.db,"userRequests",e.id),{status:"approved",uid:t.user.uid,verificationSent:!0,verificationSentAt:(new Date).toISOString()}),await(0,f.x9)(g.j,r,s),localStorage.setItem("isAdmin","true"),alert("User approved successfully. Email with temporary password sent."),j()}catch(t){throw await(0,f.x9)(g.j,r,s),localStorage.setItem("isAdmin","true"),t}}catch(t){console.error("Error in approval process:",t),alert(`Error approving user: ${t.message}`)}})(e),children:"Approve"}),(0,q.jsx)(i.A,{variant:"contained",color:"error",onClick:()=>(async e=>{if(window.confirm(`Are you sure you want to reject ${e.name}'s registration request?`))try{const s=g.j.currentUser.email,a=await new Promise((e=>{const t=document.createElement("input");t.type="password",t.placeholder="Enter admin password";const r=document.createElement("div");r.style.position="fixed",r.style.top="50%",r.style.left="50%",r.style.transform="translate(-50%, -50%)",r.style.backgroundColor="white",r.style.padding="20px",r.style.boxShadow="0 0 10px rgba(0,0,0,0.5)",r.style.zIndex="1000",r.appendChild(t);const s=document.createElement("button");s.textContent="Submit",s.onclick=()=>{r.remove(),e(t.value)},r.appendChild(s),document.body.appendChild(r),t.focus()}));try{await(0,f.x9)(g.j,s,a)}catch(t){return void alert("Invalid admin password. Rejection cancelled.")}await(0,h.mZ)((0,h.H9)(g.db,"userRequests",e.id),{status:"rejected",rejectedAt:(new Date).toISOString(),rejectedBy:s});try{await _({to:e.email,name:e.name,subject:"Registration Request Status",html:"Your registration request has been declined."})}catch(r){console.error("Error sending rejection email:",r)}alert("User registration rejected successfully."),j()}catch(t){console.error("Error rejecting user:",t),alert(`Error rejecting user: ${t.message}`)}})(e),children:"Reject"})]})})]},e.id)))})]})})]})}}}]);
//# sourceMappingURL=698.4b104484.chunk.js.map