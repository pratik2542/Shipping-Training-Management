"use strict";(self.webpackChunkddrops=self.webpackChunkddrops||[]).push([[706],{706:(e,t,r)=>{r.r(t),r.d(t,{default:()=>k});var a=r(5043),i=r(9252),s=r(3336),n=r(1045),o=r(5865),l=r(6446),d=r(5795),c=r(1906),m=r(9336),u=r(9786),h=r(6822),g=r(3216),x=r(6325),p=r(3612),f=r(5472),A=r(5983),b=r(8483),v=r(7392),y=r(1637);var j=r(6360),S=r(9792),w=r(579);const C=["pratikmak2542@gmail.com"],k=()=>{console.log("API URL:",{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_API_URL);const[e,t]=(0,a.useState)(""),[r,k]=(0,a.useState)(""),[R,T]=(0,a.useState)(""),[P,W]=(0,a.useState)(""),[_,I]=(0,a.useState)(!1),[E,q]=(0,a.useState)(!1),[F,O]=(0,a.useState)(!1),[z,D]=(0,a.useState)(!1),U=(0,g.Zp)(),G={py:1.5,fontSize:"1rem",fontWeight:500,height:"48px",textTransform:"none",letterSpacing:"0.3px","&:hover":{transform:"translateY(-2px)",transition:"transform 0.2s"}},J={...G,borderColor:"primary.main","&:hover":{...G["&:hover"],borderColor:"primary.dark",backgroundColor:"rgba(25, 118, 210, 0.04)"}},L={...G,height:"42px",backgroundColor:"white",color:"primary.main",border:"1px solid",borderColor:"primary.light",fontWeight:400,fontSize:"0.9rem",boxShadow:"0 2px 4px rgba(0,0,0,0.05)","& .MuiButton-startIcon":{marginRight:1},"&:hover":{backgroundColor:"primary.main",color:"white",boxShadow:"0 4px 8px rgba(0,0,0,0.1)",transform:"translateY(-2px)",transition:"all 0.2s ease-in-out"}},M=async e=>{console.log("Sending notification data:",e);try{const t=await fetch((e=>{const t=`https://shipping-management.vercel.app/api${e}`;return console.log("API Request:",{url:t,environment:"production"}),t})("notify-admin"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:e.name,email:e.email})});if(!t.ok){const e=await t.json();throw new Error(e.error||"Failed to send notification")}const r=await t.json();return console.log("Server response:",r),r}catch(P){throw console.error("Notification error:",P),new Error("Failed to send registration notification. Please try again.")}};return(0,w.jsx)(i.A,{component:"main",maxWidth:"xs",children:(0,w.jsxs)(s.A,{elevation:3,sx:{marginTop:8,padding:4,display:"flex",flexDirection:"column",alignItems:"center"},children:[(0,w.jsx)(n.A,{sx:{m:1,bgcolor:"primary.main"},children:(0,w.jsx)(x.A,{})}),(0,w.jsx)(o.A,{component:"h1",variant:"h5",sx:{mb:3},children:E?"Register":_?"Create Test Account":"Sign in"}),P&&(0,w.jsx)(o.A,{color:"error",sx:{mb:2},children:P}),(0,w.jsx)(l.A,{component:"form",onSubmit:E?async t=>{if(t.preventDefault(),!z){D(!0);try{const t=(0,f.P)((0,f.rJ)(h.db,"userRequests"),(0,f._M)("email","==",e),(0,f._M)("status","==","pending"));if(!(await(0,f.GG)(t)).empty)return alert("You already have a pending registration request."),void D(!1);const r={name:R,email:e,status:"pending",createdAt:(new Date).toISOString(),isTestUser:!1};await M(r),await(0,f.gS)((0,f.rJ)(h.db,"userRequests"),r),alert("Registration request submitted successfully."),U("/pending-status",{state:{email:e}})}catch(P){console.error("Registration failed:",P),W(`Registration failed: ${P.message}`),alert("Failed to submit registration. Please try again.")}finally{D(!1)}}}:_?async t=>{t.preventDefault();try{await(0,u.eJ)(p.z,e,r),localStorage.setItem("isTestUser","true"),U("/dashboard")}catch(P){W(P.message)}}:async t=>{t.preventDefault();try{if(await(0,u.x9)(h.j,e,r),"tempPassword123"===r)return void U("/reset-password",{state:{fromTempPassword:!0}});if(C.includes(e)){const e=(0,f.P)((0,f.rJ)(h.db,"userRequests"),(0,f._M)("status","==","pending")),t=await(0,f.GG)(e);return localStorage.setItem("isAdmin","true"),void(t.size>0?U("/admin/verify"):U("/dashboard"))}if(F)await(0,u.x9)(p.z,e,r),localStorage.setItem("isTestUser","true");else{await(0,u.x9)(h.j,e,r);const t=(0,f.P)((0,f.rJ)(h.db,"userRequests"),(0,f._M)("email","==",e),(0,f._M)("status","==","pending"));if(!(await(0,f.GG)(t)).empty)return await h.j.signOut(),void W("Your account is pending approval. Please wait for admin verification.");localStorage.removeItem("isAdmin"),localStorage.removeItem("isTestUser"),U("/dashboard")}}catch(P){W(P.message)}},sx:{mt:1},children:E?(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(d.A,{margin:"normal",required:!0,fullWidth:!0,label:"Full Name",value:R,onChange:e=>T(e.target.value),sx:{mb:2}}),(0,w.jsxs)(l.A,{sx:{position:"relative"},children:[(0,w.jsx)(d.A,{margin:"normal",required:!0,fullWidth:!0,label:"Email Address",value:e,onChange:e=>t(e.target.value),sx:{mb:3}}),(0,w.jsx)(b.A,{title:"After your registration is approved, you'll receive an email with a temporary password to log in.",arrow:!0,placement:"top",children:(0,w.jsx)(v.A,{sx:{position:"absolute",right:-40,top:"50%",transform:"translateY(-50%)"},children:(0,w.jsx)(A.A,{color:"primary",fontSize:"small"})})})]}),(0,w.jsx)(c.A,{type:"submit",fullWidth:!0,variant:"contained",color:"primary",sx:{...G,mt:3,mb:2},disabled:z,children:z?(0,w.jsxs)(l.A,{sx:{display:"flex",alignItems:"center"},children:[(0,w.jsx)(y.A,{size:24,sx:{mr:1}}),"Registering..."]}):"Register"}),(0,w.jsx)(c.A,{fullWidth:!0,variant:"outlined",onClick:()=>{q(!1),T("")},sx:{...J,mt:1},children:"Back to Login"})]}):(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(d.A,{margin:"normal",required:!0,fullWidth:!0,label:"Email Address",value:e,onChange:e=>t(e.target.value),sx:{mb:2}}),(0,w.jsx)(d.A,{margin:"normal",required:!0,fullWidth:!0,label:"Password",type:"password",value:r,onChange:e=>k(e.target.value),sx:{mb:3}}),_||E?(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(c.A,{type:"submit",fullWidth:!0,variant:"contained",color:"warning",sx:{...G,mt:3,mb:2},children:"Create Test Account"}),(0,w.jsx)(c.A,{fullWidth:!0,variant:"outlined",onClick:()=>{I(!1),O(!1)},sx:{...J,mt:1},children:"Back to Login"})]}):(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(c.A,{type:"submit",fullWidth:!0,variant:"contained",sx:G,children:"Sign In"}),(0,w.jsxs)(l.A,{sx:{display:"flex",gap:2,mt:3,mb:3,width:"100%"},children:[(0,w.jsx)(c.A,{fullWidth:!0,onClick:()=>U("/check-status"),sx:L,startIcon:(0,w.jsx)(j.A,{sx:{fontSize:20}}),children:"Check Status"}),(0,w.jsx)(c.A,{fullWidth:!0,onClick:()=>U("/forgot-password"),sx:L,startIcon:(0,w.jsx)(S.A,{sx:{fontSize:20}}),children:"Reset Password"})]}),(0,w.jsx)(m.A,{sx:{my:2},children:(0,w.jsx)(o.A,{variant:"body2",color:"text.secondary",children:"or"})}),(0,w.jsx)(c.A,{fullWidth:!0,variant:"outlined",onClick:()=>q(!0),sx:{...J,mb:1},children:"Create Account"}),(0,w.jsx)(c.A,{fullWidth:!0,variant:"outlined",onClick:()=>{I(!0),O(!0)},sx:J,children:"Create Test Account"})]})]})})]})})}}}]);
//# sourceMappingURL=706.0d719e70.chunk.js.map