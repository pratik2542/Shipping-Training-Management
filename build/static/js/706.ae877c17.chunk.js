"use strict";(self.webpackChunkPM=self.webpackChunkPM||[]).push([[706],{706:(e,t,a)=>{a.r(t),a.d(t,{default:()=>P});var r=a(5043),i=a(9252),s=a(3336),o=a(1045),n=a(5865),l=a(6446),d=a(5795),c=a(1906),m=a(9336),u=a(9786),p=a(6822),h=a(3216),g=a(6325),x=a(3612),A=a(5472),f=a(5983),S=a(8483),w=a(7392),b=a(1637);var v=a(6360),y=a(9792),E=a(9187),_=a(579);const j=["pratikmak2542@gmail.com"],P=()=>{console.log("API URL:",{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_FIREBASE_API_KEY:"AIzaSyBLAlnwwRasaBO88OsM8GsJ0os-8bwAT08",REACT_APP_FIREBASE_APP_ID:"1:419919268111:web:51bd26092cf399c52f967a",REACT_APP_FIREBASE_AUTH_DOMAIN:"ddropd-dd5d7.firebaseapp.com",REACT_APP_FIREBASE_MEASUREMENT_ID:"G-8WLP60CC7T",REACT_APP_FIREBASE_MESSAGING_SENDER_ID:"419919268111",REACT_APP_FIREBASE_PROJECT_ID:"ddropd-dd5d7",REACT_APP_FIREBASE_STORAGE_BUCKET:"ddropd-dd5d7.appspot.com"}.REACT_APP_API_URL);const[e,t]=(0,r.useState)(""),[a,P]=(0,r.useState)(""),[C,R]=(0,r.useState)(""),[T,I]=(0,r.useState)(""),[k,W]=(0,r.useState)(!1),[F,O]=(0,r.useState)(!1),[B,D]=(0,r.useState)(!1),[U,G]=(0,r.useState)(!1),q=(0,h.Zp)(),z={py:1.5,fontSize:"1rem",fontWeight:500,height:"48px",textTransform:"none",letterSpacing:"0.3px","&:hover":{transform:"translateY(-2px)",transition:"transform 0.2s"}},M={...z,borderColor:"primary.main","&:hover":{...z["&:hover"],borderColor:"primary.dark",backgroundColor:"rgba(25, 118, 210, 0.04)"}},N={...z,height:"42px",backgroundColor:"white",color:"primary.main",border:"1px solid",borderColor:"primary.light",fontWeight:400,fontSize:"0.9rem",boxShadow:"0 2px 4px rgba(0,0,0,0.05)","& .MuiButton-startIcon":{marginRight:1},"&:hover":{backgroundColor:"primary.main",color:"white",boxShadow:"0 4px 8px rgba(0,0,0,0.1)",transform:"translateY(-2px)",transition:"all 0.2s ease-in-out"},minWidth:130,whiteSpace:"nowrap"},J=async e=>{console.log("Sending notification data:",e);try{const t=await fetch((e=>{const t=`https://shipping-management.vercel.app${e}`;return console.log("API Request to:",t),t})("notify-admin"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:e.name,email:e.email})});if(!t.ok){const e=await t.json();throw new Error(e.error||"Failed to send notification")}const a=await t.json();return console.log("Server response:",a),a}catch(T){throw console.error("Notification error:",T),new Error("Failed to send registration notification. Please try again.")}};return(0,_.jsx)(i.A,{component:"main",maxWidth:"xs",children:(0,_.jsxs)(s.A,{elevation:3,sx:{marginTop:8,padding:4,display:"flex",flexDirection:"column",alignItems:"center"},children:[(0,_.jsx)(o.A,{sx:{m:1,bgcolor:"primary.main"},children:(0,_.jsx)(g.A,{})}),(0,_.jsx)(n.A,{component:"h1",variant:"h5",sx:{mb:3},children:F?"Register":k?"Create Test Account":"Sign in"}),T&&(0,_.jsx)(n.A,{color:"error",sx:{mb:2},children:T}),(0,_.jsx)(l.A,{component:"form",onSubmit:F?async t=>{if(t.preventDefault(),!U){G(!0),I("");try{if(!0===(await(0,E.A$)(e)).registered)return I("An account with this email already exists. Please log in instead."),void G(!1);const t=(0,A.P)((0,A.rJ)(p.db,"userRequests"),(0,A._M)("email","==",e)),a=await(0,A.GG)(t);if(!a.empty){const e=a.docs.find((e=>"approved"===e.data().status)),t=a.docs.find((e=>"pending"===e.data().status));if(e)return I("This email is already registered and approved. Please log in instead."),void G(!1);if(t)return I("You already have a pending registration request. Please wait for approval."),void G(!1)}const r={name:C,email:e,status:"pending",createdAt:(new Date).toISOString(),isTestUser:!1};await J(r),await(0,A.gS)((0,A.rJ)(p.db,"userRequests"),r),alert("Registration request submitted successfully."),q("/pending-status",{state:{email:e}})}catch(T){console.error("Registration failed:",T),I(`Registration failed: ${T.message}`)}finally{G(!1)}}}:k?async t=>{t.preventDefault();try{await(0,u.eJ)(x.z,e,a),localStorage.setItem("isTestUser","true"),q("/dashboard")}catch(T){I(T.message)}}:async t=>{t.preventDefault();try{if(await(0,u.x9)(p.j2,e,a),"tempPassword123"===a)return void q("/reset-password",{state:{fromTempPassword:!0}});if(j.includes(e)){localStorage.setItem("adminEmail",e),localStorage.setItem("isAdmin","true");const t=(0,A.P)((0,A.rJ)(p.db,"userRequests"),(0,A._M)("status","==","pending"));return void((await(0,A.GG)(t)).size>0?q("/admin/verify"):q("/dashboard"))}if(B)await(0,u.x9)(x.z,e,a),localStorage.setItem("isTestUser","true");else{await(0,u.x9)(p.j2,e,a);const t=(0,A.P)((0,A.rJ)(p.db,"userRequests"),(0,A._M)("email","==",e),(0,A._M)("status","==","pending"));if(!(await(0,A.GG)(t)).empty)return await p.j2.signOut(),void I("Your account is pending approval. Please wait for admin verification.");localStorage.removeItem("isAdmin"),localStorage.removeItem("isTestUser"),q("/dashboard")}}catch(T){I(T.message)}},sx:{mt:1},children:F?(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(d.A,{margin:"normal",required:!0,fullWidth:!0,label:"Full Name",value:C,onChange:e=>R(e.target.value),sx:{mb:2}}),(0,_.jsxs)(l.A,{sx:{position:"relative"},children:[(0,_.jsx)(d.A,{margin:"normal",required:!0,fullWidth:!0,label:"Email Address",value:e,onChange:e=>t(e.target.value),sx:{mb:3}}),(0,_.jsx)(S.A,{title:"After your registration is approved, you'll receive an email with a temporary password to log in.",arrow:!0,placement:"top",children:(0,_.jsx)(w.A,{sx:{position:"absolute",right:-40,top:"50%",transform:"translateY(-50%)"},children:(0,_.jsx)(f.A,{color:"primary",fontSize:"small"})})})]}),(0,_.jsx)(c.A,{type:"submit",fullWidth:!0,variant:"contained",color:"primary",sx:{...z,mt:3,mb:2},disabled:U,children:U?(0,_.jsxs)(l.A,{sx:{display:"flex",alignItems:"center"},children:[(0,_.jsx)(b.A,{size:24,sx:{mr:1}}),"Registering..."]}):"Register"}),(0,_.jsx)(c.A,{fullWidth:!0,variant:"outlined",onClick:()=>{O(!1),R("")},sx:{...M,mt:1},children:"Back to Login"})]}):(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(d.A,{margin:"normal",required:!0,fullWidth:!0,label:"Email Address",value:e,onChange:e=>t(e.target.value),sx:{mb:2}}),(0,_.jsx)(d.A,{margin:"normal",required:!0,fullWidth:!0,label:"Password",type:"password",value:a,onChange:e=>P(e.target.value),sx:{mb:3}}),k||F?(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(c.A,{type:"submit",fullWidth:!0,variant:"contained",color:"warning",sx:{...z,mt:3,mb:2},children:"Create Test Account"}),(0,_.jsx)(c.A,{fullWidth:!0,variant:"outlined",onClick:()=>{W(!1),D(!1)},sx:{...M,mt:1},children:"Back to Login"})]}):(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(c.A,{type:"submit",fullWidth:!0,variant:"contained",sx:z,children:"Sign In"}),(0,_.jsxs)(l.A,{sx:{display:"flex",justifyContent:"space-between",mt:3,mb:3,width:"100%"},children:[(0,_.jsx)(c.A,{sx:{...N,flex:"1 1 45%",mr:1},onClick:()=>q("/check-status"),startIcon:(0,_.jsx)(v.A,{sx:{fontSize:20}}),children:"Check Status"}),(0,_.jsx)(c.A,{sx:{...N,flex:"1 1 45%",ml:1},onClick:()=>q("/forgot-password"),startIcon:(0,_.jsx)(y.A,{sx:{fontSize:20}}),children:"Reset Password"})]}),(0,_.jsx)(m.A,{sx:{my:2},children:(0,_.jsx)(n.A,{variant:"body2",color:"text.secondary",children:"or"})}),(0,_.jsx)(c.A,{fullWidth:!0,variant:"outlined",onClick:()=>O(!0),sx:{...M,mb:1},children:"Create Account"}),(0,_.jsx)(c.A,{fullWidth:!0,variant:"outlined",onClick:()=>{W(!0),D(!0)},sx:M,children:"Create Test Account"})]})]})})]})})}},9187:(e,t,a)=>{a.d(t,{A$:()=>o,BE:()=>n,kg:()=>s});var r=a(6822);const i=async(e,t)=>{try{const a=(0,r.CG)();if(!a)throw new Error("API key not available");const i=`https://identitytoolkit.googleapis.com/v1/accounts:${e}?key=${a}`,s=await fetch(i,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});return await s.json()}catch(a){throw console.error(`Firebase Auth API error (${e}):`,a),a}},s=(e,t)=>i("signUp",{email:e,password:t,returnSecureToken:!1}),o=e=>i("createAuthUri",{identifier:e,continueUri:window.location.href}),n=(e,t)=>i("signInWithPassword",{email:e,password:t,returnSecureToken:!0})}}]);
//# sourceMappingURL=706.ae877c17.chunk.js.map